# Вклад у проект: Етап аналізу даних (Регресія)

**Автор:** Zhukovskyi Artem  
**Етап:** Data Analysis Stage (Regression Modeling)

## Огляд

Цей документ описує реалізацію етапу побудови регресійних моделей машинного навчання для передбачення оцінки аніме (`Score`). Було побудовано пайплайн для тренування, оцінки та відбору найкращих моделей з використанням бібліотек `scikit-learn` та `pandas`.

## Реалізований функціонал

### 1. Підготовка та завантаження даних
- Використано модуль для завантаження підготовлених ML-датасетів (train/test спліти).
- Реалізовано обробку пропущених значень (fillna) для забезпечення стабільності роботи моделей.

### 2. Моделювання (Regression Pipeline)
**Модуль:** `data_analysis/regression_modeling.py`

Було проведено експеримент з тренуванням **20 різних моделей регресії**, серед яких:
- Лінійні моделі (LinearRegression, Ridge, Lasso, ElasticNet)
- Дерева рішень та ансамблі (DecisionTree, RandomForest, ExtraTrees, GradientBoosting, AdaBoost)
- Інші алгоритми (KNeighbors, SVR, MLPRegressor тощо)

### 3. Оцінка та вибір найкращих моделей
Для оцінки якості моделей використовувалися наступні метрики:
- **RMSE (Root Mean Squared Error):** Основна метрика для мінімізації помилки передбачення.
- **MAE (Mean Absolute Error):** Середня абсолютна помилка.
- **R² (Coefficient of Determination):** Коефіцієнт детермінації (відсоток поясненої дисперсії).

За результатами експериментів було відібрано **ТОП-3 найкращі моделі**, які показали найвищу точність (найменший RMSE та найбільший R²):
1. **Random Forest Regressor**
2. **Extra Trees Regressor**
3. **Bagging Regressor**

Саме ці три моделі були залишені у фінальній версії коду для подальшого використання.

### 4. Збереження моделей та результатів
- **Персистентність:** Реалізовано механізм збереження натренованих моделей у форматі `.joblib` в директорію `data/models/regression/`. Це дозволяє уникати повторного тренування "важких" ансамблевих моделей при кожному запуску.
- **Логування:** Результати порівняння моделей (Leaderboard) автоматично зберігаються у CSV файл `data/results/regression_leaderboard.csv`.
- **Вивід:** Реалізовано форматований вивід результатів у консоль з підсвіткою ТОП-3 моделей.

## Технічні деталі

- **Бібліотеки:** `scikit-learn`, `pandas`, `numpy`, `joblib`.
- **Оптимізація:** Використано параметр `n_jobs=-1` для паралельного тренування ансамблевих моделей, що значно пришвидшує процес.
- **Інтеграція:** Пайплайн інтегровано в основний додаток (`main.py`) через меню, що дозволяє користувачу легко запускати процес моделювання.

## Результати

Моделі на основі дерев рішень (Random Forest та Extra Trees) показали найкращі результати, досягнувши R² близько **0.68-0.69**, що є гарним показником для даного набору даних.

