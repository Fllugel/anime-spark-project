# –í–∫–ª–∞–¥ —É –ø—Ä–æ–µ–∫—Ç: –ï—Ç–∞–ø –º–∞—à–∏–Ω–Ω–æ–≥–æ –Ω–∞–≤—á–∞–Ω–Ω—è (–∫–ª–∞—Å–∏—Ñ—ñ–∫–∞—Ü—ñ—è)

**–ê–≤—Ç–æ—Ä:** Arii Doroshenko
**–ï—Ç–∞–ø:** Machine Learning ‚Äî Classification Stage

---

## –û–≥–ª—è–¥

–¶–µ–π –¥–æ–∫—É–º–µ–Ω—Ç –æ–ø–∏—Å—É—î —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—é –µ—Ç–∞–ø—É –º–∞—à–∏–Ω–Ω–æ–≥–æ –Ω–∞–≤—á–∞–Ω–Ω—è –¥–ª—è –∑–∞–¥–∞—á—ñ **–∫–ª–∞—Å–∏—Ñ—ñ–∫–∞—Ü—ñ—ó —Å—Ç–∞—Ç—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞** –Ω–∞ –æ—Å–Ω–æ–≤—ñ –π–æ–≥–æ –∞–Ω—ñ–º–µ-–ø–æ–≤–µ–¥—ñ–Ω–∫–∏.
–†–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ –ø–æ–≤–Ω–∏–π ML-pipeline, —è–∫–∏–π –≤–∫–ª—é—á–∞—î:

* –ø—ñ–¥–≥–æ—Ç–æ–≤–∫—É –∫–ª–∞—Å–∏—Ñ—ñ–∫–∞—Ü—ñ–π–Ω–æ–≥–æ –¥–∞—Ç–∞—Å–µ—Ç—É —ñ–∑ —Å–∏—Ä–∏—Ö CSV-—Ñ–∞–π–ª—ñ–≤
* —Ñ–æ—Ä–º—É–≤–∞–Ω–Ω—è –æ–∑–Ω–∞–∫ (features) –Ω–∞ –æ—Å–Ω–æ–≤—ñ —ñ—Å—Ç–æ—Ä—ñ—ó –æ—Ü—ñ–Ω—é–≤–∞–Ω–Ω—è
* —Ä–æ–∑–±–∏—Ç—Ç—è –¥–∞—Ç–∞—Å–µ—Ç—É –Ω–∞ train/test
* —Ç—Ä–µ–Ω—É–≤–∞–Ω–Ω—è 3 –º–æ–¥–µ–ª–µ–π —Ä—ñ–∑–Ω–æ—ó —Å–∫–ª–∞–¥–Ω–æ—Å—Ç—ñ
* –≤–∏–±—ñ—Ä –Ω–∞–π–∫—Ä–∞—â–æ—ó –º–æ–¥–µ–ª—ñ –∑–∞ –º–µ—Ç—Ä–∏–∫–∞–º–∏ F1 —Ç–∞ Accuracy
* –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è –º–æ–¥–µ–ª–µ–π —É —Ñ–∞–π–ª–æ–≤—É —Å–∏—Å—Ç–µ–º—É

–†–µ–∞–ª—ñ–∑–∞—Ü—ñ—è –ø–æ–≤–Ω—ñ—Å—Ç—é —ñ–Ω—Ç–µ–≥—Ä–æ–≤–∞–Ω–∞ –≤ –≥–æ–ª–æ–≤–Ω–µ –º–µ–Ω—é –ø—Ä–æ—î–∫—Ç—É —Ç–∞ –ø—Ä–∞—Ü—é—î –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –ø—Ä–∏ –≤–∏–±–æ—Ä—ñ —Ä–µ–∂–∏–º—É ¬´–ö–ª–∞—Å–∏—Ñ—ñ–∫–∞—Ü—ñ—è ML¬ª.

---

## –©–æ –±—É–ª–æ —Ä–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ

---

## 1. –ü—ñ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞—Ç–∞—Å–µ—Ç—É –¥–ª—è –∫–ª–∞—Å–∏—Ñ—ñ–∫–∞—Ü—ñ—ó

**–ú–æ–¥—É–ª—å:** `data_analysis/prepare_classification_dataset.py`

–†–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ —Ñ—É–Ω–∫—Ü—ñ—é —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –¥–∞—Ç–∞—Ñ—Ä–µ–π–º—É –¥–ª—è –∫–ª–∞—Å–∏—Ñ—ñ–∫–∞—Ü—ñ—ó —Å—Ç–∞—Ç—ñ (`gender_encoded`) –Ω–∞ –æ—Å–Ω–æ–≤—ñ —Ç—Ä—å–æ—Ö —Å–∏—Ä–∏—Ö –¥–∂–µ—Ä–µ–ª:

* `users-details-2023.csv` ‚Äî —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤
* `users-score-2023.csv` ‚Äî —ñ—Å—Ç–æ—Ä—ñ—è –æ—Ü—ñ–Ω—é–≤–∞–Ω–Ω—è
* `anime-filtered.csv` ‚Äî –∫–∞—Ç–∞–ª–æ–≥ –∞–Ω—ñ–º–µ

### –û—Å–Ω–æ–≤–Ω—ñ –∫—Ä–æ–∫–∏:

1. **–§—ñ–ª—å—Ç—Ä–∞—Ü—ñ—è –≤–∞–ª—ñ–¥–Ω–∏—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ –∑—ñ —Å—Ç–∞—Ç—Ç—é (M/F).**

2. **Sampling –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤** (–¥–æ 50 000) –¥–ª—è –∫–æ–Ω—Ç—Ä–æ–ª—é –æ–±—Å—è–≥—É –¥–∞–Ω–∏—Ö.

3. **–ß–∏—Ç–∞–Ω–Ω—è –≤–µ–ª–∏–∫–æ–≥–æ ratings-—Ñ–∞–π–ª—É —á–∞—Å—Ç–∏–Ω–∞–º–∏ (chunk processing)**
   ‚Äî —â–æ–± —É–Ω–∏–∫–Ω—É—Ç–∏ –ø–µ—Ä–µ–ø–æ–≤–Ω–µ–Ω–Ω—è –ø–∞–º º—è—Ç—ñ.

4. **–ê–≥—Ä–µ–≥–∞—Ü—ñ—è –ø–æ–≤–µ–¥—ñ–Ω–∫–æ–≤–∏—Ö –æ–∑–Ω–∞–∫:**

   * —Å–µ—Ä–µ–¥–Ω—è –æ—Ü—ñ–Ω–∫–∞ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
   * –∫—ñ–ª—å–∫—ñ—Å—Ç—å –æ—Ü—ñ–Ω–µ–Ω–∏—Ö —Ç–∞–π—Ç–ª—ñ–≤
   * —á–∞—Å—Ç–∫–∞ –≤–∏—Å–æ–∫–∏—Ö/–Ω–∏–∑—å–∫–∏—Ö –æ—Ü—ñ–Ω–æ–∫
   * –æ—Ü—ñ–Ω–∫–∏ –∑–∞ –∂–∞–Ω—Ä–∞–º–∏
   * —Å–µ—Ä–µ–¥–Ω—è —Ç—Ä–∏–≤–∞–ª—ñ—Å—Ç—å –ø–µ—Ä–µ–≥–ª—è–¥—É
   * —É–ª—é–±–ª–µ–Ω—ñ —Ç–∏–ø–∏ –∞–Ω—ñ–º–µ

5. **–ö–æ–¥—É–≤–∞–Ω–Ω—è —Ü—ñ–ª—å–æ–≤–æ—ó –∑–º—ñ–Ω–Ω–æ—ó:**

   * `Male ‚Üí 0`
   * `Female ‚Üí 1`

6. **–ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É** —É —Ñ–æ—Ä–º–∞—Ç—ñ:

   ```
   data/ml_datasets/classification/train.csv
   data/ml_datasets/classification/test.csv
   ```

   –∑ –º–æ–∂–ª–∏–≤—ñ—Å—Ç—é –∑–∞–ø–∏—Å—É —ñ –≤ Parquet.

### –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω—ñ –æ–ø–µ—Ä–∞—Ü—ñ—ó:

* Pandas merge
* GroupBy aggregation
* Type casting
* Chunked file reading
* Stratified splitting

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** —è–∫—ñ—Å–Ω–∏–π –∑–±–∞–ª–∞–Ω—Å–æ–≤–∞–Ω–∏–π –¥–∞—Ç–∞—Å–µ—Ç –¥–ª—è –Ω–∞–≤—á–∞–Ω–Ω—è –º–æ–¥–µ–ª–µ–π.

---

## 2. –¢—Ä–µ–Ω—É–≤–∞–Ω–Ω—è –º–æ–¥–µ–ª–µ–π –∫–ª–∞—Å–∏—Ñ—ñ–∫–∞—Ü—ñ—ó

**–ú–æ–¥—É–ª—å:** `classification_modeling.py` 

–†–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ –ø—Ä–æ—Ü–µ–¥—É—Ä—É —Ç—Ä–µ–Ω—É–≤–∞–Ω–Ω—è —Ç–∞ –æ—Ü—ñ–Ω–∫–∏ —Ç—Ä—å–æ—Ö –º–æ–¥–µ–ª–µ–π:

### üîπ 1. Logistic Regression (–±–∞–∑–æ–≤–∞ –º–æ–¥–µ–ª—å)

* –®–≤–∏–¥–∫–∞, —ñ–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–æ–≤–∞–Ω–∞ –º–æ–¥–µ–ª—å
* –î–∞—î baseline-—è–∫—ñ—Å—Ç—å

### üîπ 2. Random Forest (–¥–µ—Ä–µ–≤–∞ —Ä—ñ—à–µ–Ω—å)

* –†–æ–±–∏—Ç—å —Å–∫–ª–∞–¥–Ω—ñ –Ω–µ–ª—ñ–Ω—ñ–π–Ω—ñ —Ä—ñ—à–µ–Ω–Ω—è
* –°—Ç—ñ–π–∫–∞ –¥–æ —à—É–º—É —Ç–∞ –ø—Ä–æ–ø—É—â–µ–Ω–∏—Ö –∑–Ω–∞—á–µ–Ω—å

### üîπ 3. MLP Classifier (–Ω–µ–π—Ä–æ–Ω–Ω–∞ –º–µ—Ä–µ–∂–∞)

* –ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞: 128 ‚Üí 64 –Ω–µ–π—Ä–æ–Ω–∏
* –ú–æ–∂–µ –ª–æ–≤–∏—Ç–∏ —Å–∫–ª–∞–¥–Ω—ñ –≤–∑–∞—î–º–æ–∑–≤ º—è–∑–∫–∏ –º—ñ–∂ –æ–∑–Ω–∞–∫–∞–º–∏

---

## 3. –û—Ü—ñ–Ω—é–≤–∞–Ω–Ω—è –º–æ–¥–µ–ª–µ–π

–î–ª—è –∫–æ–∂–Ω–æ—ó –º–æ–¥–µ–ª—ñ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –æ–±—á–∏—Å–ª—é—é—Ç—å—Å—è:

* `Accuracy`
* `F1-score`
* —á–∞—Å —Ç—Ä–µ–Ω—É–≤–∞–Ω–Ω—è
* —Å—Ç–∞—Ç—É—Å (Loaded / Trained)

–ú–æ–¥–µ–ª—ñ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è —É:

```
data/models/classification/
```

–§–æ—Ä–º–∞—Ç: `MODEL_NAME.joblib`

–¢–∞–∫–æ–∂ —Ñ–æ—Ä–º—É—î—Ç—å—Å—è –¥–µ—Ç–∞–ª—å–Ω–∏–π **classification report**, —â–æ –≤–∫–ª—é—á–∞—î precision, recall —Ç–∞ F1 –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ –∫–ª–∞—Å—É.

---

## –¢–µ—Ö–Ω—ñ—á–Ω—ñ –¥–µ—Ç–∞–ª—ñ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó

### –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω—ñ ML-—Ç–µ—Ö–Ω—ñ–∫–∏:

* –º–∞—Å—à—Ç–∞–±—É–≤–∞–Ω–Ω—è –æ–∑–Ω–∞–∫ (implicit in LR/MLP)
* –∫–æ–¥—É–≤–∞–Ω–Ω—è —Ü—ñ–ª—å–æ–≤–æ—ó –∑–º—ñ–Ω–Ω–æ—ó
* —É—Å—É–Ω–µ–Ω–Ω—è –ø—É—Å—Ç–∏—Ö –∑–Ω–∞—á–µ–Ω—å
* —Å—Ç–∞–±—ñ–ª—å–Ω–∞ –≤–∞–ª—ñ–¥–∞—Ü—ñ—è train/test
* —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–ª—è –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è —Ç–∞ –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –º–æ–¥–µ–ª–µ–π

### –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω—ñ –±—ñ–±–ª—ñ–æ—Ç–µ–∫–∏:

* `scikit-learn`
* `pandas`, `numpy`
* `joblib`

### –Ü–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è –∑ –≥–æ–ª–æ–≤–Ω–∏–º –º–µ–Ω—é:

–£ —Ñ–∞–π–ª—ñ `main.py` –¥–æ–¥–∞–Ω–æ:

* –ø–µ—Ä–µ–≤—ñ—Ä–∫—É –Ω–∞—è–≤–Ω–æ—Å—Ç—ñ –¥–∞—Ç–∞—Å–µ—Ç—É
* –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–π –∑–∞–ø—É—Å–∫ –ø—ñ–¥–≥–æ—Ç–æ–≤–∫–∏ –¥–∞–Ω–∏—Ö
* –∑–∞–ø—É—Å–∫ —Ñ—É–Ω–∫—Ü—ñ—ó `run_classification_modeling()`

–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á—É –¥–æ—Å—Ç–∞—Ç–Ω—å–æ –≤–∏–±—Ä–∞—Ç–∏ **–æ–ø—Ü—ñ—é 3 —É –º–µ–Ω—é** ‚Äî —É—Å–µ —ñ–Ω—à–µ –≤–∏–∫–æ–Ω—É—î—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ.

---

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó

```
data_analysis/
‚îú‚îÄ‚îÄ prepare_classification_dataset.py   # —Ñ–æ—Ä–º—É–≤–∞–Ω–Ω—è –¥–∞—Ç–∞—Å–µ—Ç—É
‚îî‚îÄ‚îÄ prepare_ml_datasets.py              # —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü—ñ–π

classification_modeling.py              # —Ç—Ä–µ–Ω—É–≤–∞–Ω–Ω—è –º–æ–¥–µ–ª–µ–π
main.py                                 # —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è –≤ –º–µ–Ω—é
```

---

## –†–µ–∑—É–ª—å—Ç–∞—Ç–∏

* –°—Ç–≤–æ—Ä–µ–Ω–æ –ø–æ–≤–Ω–∏–π ML-–ø—Ä–æ—Ü–µ—Å –∫–ª–∞—Å–∏—Ñ—ñ–∫–∞—Ü—ñ—ó —Å—Ç–∞—Ç—ñ –Ω–∞ –æ—Å–Ω–æ–≤—ñ –ø–æ–≤–µ–¥—ñ–Ω–∫–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞.
* –ê–≤—Ç–æ–º–∞—Ç–∏–∑–æ–≤–∞–Ω–æ –ø—ñ–¥–≥–æ—Ç–æ–≤–∫—É, —Ç—Ä–µ–Ω—É–≤–∞–Ω–Ω—è —Ç–∞ –ª–æ–≥—É–≤–∞–Ω–Ω—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤.
* –†–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ 3 –º–æ–¥–µ–ª—ñ —Ä—ñ–∑–Ω–æ—ó —Å–∫–ª–∞–¥–Ω–æ—Å—Ç—ñ: –±–∞–∑–æ–≤–∞, –¥–µ—Ä–µ–≤–æ–ø–æ–¥—ñ–±–Ω–∞ —ñ –Ω–µ–π—Ä–æ–º–µ—Ä–µ–∂–µ–≤–∞.
* –ó–∞–±–µ–∑–ø–µ—á–µ–Ω–æ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è –º–æ–¥–µ–ª–µ–π —ñ –¥–µ—Ç–∞–ª—å–Ω–∏—Ö –º–µ—Ç—Ä–∏–∫.
* –ú–æ–¥—É–ª—å –ø–æ–≤–Ω—ñ—Å—Ç—é —ñ–Ω—Ç–µ–≥—Ä–æ–≤–∞–Ω–∏–π —É —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø—Ä–æ—î–∫—Ç—É —Ç–∞ –ø—Ä–∞—Ü—é—î –±–µ–∑ –¥–æ–¥–∞—Ç–∫–æ–≤–∏—Ö –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω—å.

---

## –í–∏—Å–Ω–æ–≤–∫–∏

–ú—ñ–π –≤–Ω–µ—Å–æ–∫ —É –ø—Ä–æ–µ–∫—Ç –ø–æ–ª—è–≥–∞—î —É —Å—Ç–≤–æ—Ä–µ–Ω–Ω—ñ **–ø–æ–≤–Ω–æ—Ü—ñ–Ω–Ω–æ–≥–æ ML-–º–æ–¥—É–ª—è –∫–ª–∞—Å–∏—Ñ—ñ–∫–∞—Ü—ñ—ó**, —è–∫–∏–π:

1. –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î —Å–∏—Ä—ñ –¥–∞–Ω—ñ –ø—Ä–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ —ñ —ó—Ö –æ—Ü—ñ–Ω–∫–∏.
2. –§–æ—Ä–º—É—î —ñ–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω–∏–π –Ω–∞–±—ñ—Ä –æ–∑–Ω–∞–∫.
3. –ó–∞–±–µ–∑–ø–µ—á—É—î —Å—Ç–∞–±—ñ–ª—å–Ω–∏–π –ø—Ä–æ—Ü–µ—Å —Ç—Ä–µ–Ω—É–≤–∞–Ω–Ω—è –º–æ–¥–µ–ª–µ–π.
4. –ê–≤—Ç–æ–º–∞—Ç–∏–∑—É—î –≤–µ—Å—å pipeline –≤—ñ–¥ –¥–∞–Ω–∏—Ö –¥–æ –º–µ—Ç—Ä–∏–∫.
5. –ü—Ä–∞—Ü—é—î —É –∑–∞–≥–∞–ª—å–Ω—ñ–π –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä—ñ Anime Spark —ñ –¥–æ–ø–æ–≤–Ω—é—î –µ—Ç–∞–ø–∏ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü—ñ—ó —Ç–∞ –±—ñ–∑–Ω–µ—Å-–ø–∏—Ç–∞–Ω—å.

