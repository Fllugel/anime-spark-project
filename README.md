# Anime Spark Project

–ü—Ä–æ–µ–∫—Ç –¥–ª—è –∞–Ω–∞–ª—ñ–∑—É –¥–∞—Ç–∞—Å–µ—Ç—É –∞–Ω—ñ–º–µ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é Apache Spark —Ç–∞ –∑—ñ—Ä—á–∞—Å—Ç–æ—ó —Å—Ö–µ–º–∏ –¥–∞–Ω–∏—Ö.

## üìã –û–ø–∏—Å

–¶–µ–π –ø—Ä–æ–µ–∫—Ç —Å—Ç–≤–æ—Ä—é—î –∑—ñ—Ä—á–∞—Å—Ç—É —Å—Ö–µ–º—É –¥–∞–Ω–∏—Ö (Star Schema) –¥–ª—è –∞–Ω–∞–ª—ñ–∑—É –∞–Ω—ñ–º–µ –¥–∞—Ç–∞—Å–µ—Ç—É, —â–æ –≤–∫–ª—é—á–∞—î:
- **Dim_User** - –≤–∏–º—ñ—Ä –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ (731,290 –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤)
- **Dim_Anime** - –≤–∏–º—ñ—Ä –∞–Ω—ñ–º–µ (40,779 –∞–Ω—ñ–º–µ)
- **Dim_Date** - –≤–∏–º—ñ—Ä –¥–∞—Ç–∏ (9,497 –¥–∞—Ç)
- **Fact_UserRatings** - —Ç–∞–±–ª–∏—Ü—è —Ñ–∞–∫—Ç—ñ–≤ –∑ –æ—Ü—ñ–Ω–∫–∞–º–∏ (23,866,768 –æ—Ü—ñ–Ω–æ–∫)

## üöÄ –®–≤–∏–¥–∫–∏–π —Å—Ç–∞—Ä—Ç

### –í–∏–º–æ–≥–∏

- Docker Desktop –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–π —Ç–∞ –∑–∞–ø—É—â–µ–Ω–∏–π
- –î–∞–Ω—ñ –¥–∞—Ç–∞—Å–µ—Ç—É –≤ –ø–∞–ø—Ü—ñ `data/`

### –ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ Docker

1. **–ü–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—è, —â–æ Docker –∑–∞–ø—É—â–µ–Ω–∏–π**

2. **–í–∏–∫–æ—Ä–∏—Å—Ç–∞–π—Ç–µ –≥–æ—Ç–æ–≤–∏–π —Å–∫—Ä–∏–ø—Ç** (—Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–æ):
   
   **–î–ª—è Mac/Linux:**
   ```bash
   ./scripts/run_docker.sh
   ```
   
   **–î–ª—è Windows:**
   ```batch
   scripts\run_docker.bat
   ```

3. **–ê–±–æ –∑–∞–ø—É—Å—Ç—ñ—Ç—å –≤—Ä—É—á–Ω—É**:
   
   **Mac/Linux:**
   ```bash
   # –ó–±—ñ—Ä–∫–∞ –æ–±—Ä–∞–∑—É
   docker build -f docker/Dockerfile -t my-spark-img .
   
   # –ó–∞–ø—É—Å–∫
   docker run --rm -v "$(pwd):/app" -w /app my-spark-img python main.py
   ```
   
   **Windows:**
   ```batch
   # –ó–±—ñ—Ä–∫–∞ –æ–±—Ä–∞–∑—É
   docker build -f docker/Dockerfile.uu -t my-spark .
   
   # –ó–∞–ø—É—Å–∫
   docker run --rm -v "%cd%":/app my-spark python main.py
   ```

### –©–æ –≤—ñ–¥–±—É–≤–∞—î—Ç—å—Å—è –ø—Ä–∏ –∑–∞–ø—É—Å–∫—É

1. ‚úÖ –°—Ç–≤–æ—Ä—é—î—Ç—å—Å—è –∑—ñ—Ä—á–∞—Å—Ç–∞ —Å—Ö–µ–º–∞ –¥–∞–Ω–∏—Ö
2. ‚úÖ –ü–µ—Ä–µ–≤—ñ—Ä—è—î—Ç—å—Å—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å—Ç–≤–æ—Ä–µ–Ω–∏—Ö –≤–∏–º—ñ—Ä—ñ–≤
3. ‚úÖ –°—Ö–µ–º–∞ –∑–±–µ—Ä—ñ–≥–∞—î—Ç—å—Å—è —É Parquet —Ñ–æ—Ä–º–∞—Ç—ñ (–æ–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ)
4. ‚úÖ –ì–æ—Ç–æ–≤–∞ –¥–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –¥–ª—è –±—ñ–∑–Ω–µ—Å-–ø–∏—Ç–∞–Ω—å

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç—É

```
anime-spark-project/
‚îú‚îÄ‚îÄ data/                    # –°–∏—Ä—ñ –¥–∞–Ω—ñ –¥–∞—Ç–∞—Å–µ—Ç—É (–Ω–µ –≤ Git)
‚îÇ   ‚îú‚îÄ‚îÄ anime-dataset-2023.csv
‚îÇ   ‚îú‚îÄ‚îÄ users-details-2023.csv
‚îÇ   ‚îú‚îÄ‚îÄ users-score-2023.csv
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îú‚îÄ‚îÄ docker/                  # Docker –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó
‚îÇ   ‚îú‚îÄ‚îÄ Dockerfile           # –ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è –¥–ª—è Mac/Linux
‚îÇ   ‚îî‚îÄ‚îÄ Dockerfile.uu        # –ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è –¥–ª—è Windows
‚îú‚îÄ‚îÄ scripts/                 # –°–∫—Ä–∏–ø—Ç–∏ –¥–ª—è –∑–∞–ø—É—Å–∫—É
‚îÇ   ‚îú‚îÄ‚îÄ run_docker.sh        # –°–∫—Ä–∏–ø—Ç –∑–∞–ø—É—Å–∫—É –¥–ª—è Mac/Linux
‚îÇ   ‚îî‚îÄ‚îÄ run_docker.bat       # –°–∫—Ä–∏–ø—Ç –∑–∞–ø—É—Å–∫—É –¥–ª—è Windows
‚îú‚îÄ‚îÄ transformation/          # –ú–æ–¥—É–ª—ñ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü—ñ—ó —Ç–∞ –±—ñ–∑–Ω–µ—Å-–ª–æ–≥—ñ–∫–∏ –¥–∞–Ω–∏—Ö
‚îÇ   ‚îú‚îÄ‚îÄ dataset_info.py      # –Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ –¥–∞—Ç–∞—Å–µ—Ç
‚îÇ   ‚îú‚îÄ‚îÄ numeric_statistics.py # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —á–∏—Å–ª–æ–≤–∏—Ö –ø–æ–ª—ñ–≤
‚îÇ   ‚îú‚îÄ‚îÄ data_extraction.py   # –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –∑—ñ—Ä—á–∞—Å—Ç–æ—ó —Å—Ö–µ–º–∏ (Dim_* + Fact_UserRatings)
‚îÇ   ‚îî‚îÄ‚îÄ business_questions.py # –ë—ñ–∑–Ω–µ—Å-–ø–∏—Ç–∞–Ω–Ω—è —Ç–∞ –∞–Ω–∞–ª—ñ—Ç–∏–∫–∞ –Ω–∞ –∑—ñ—Ä—á–∞—Å—Ç—ñ–π —Å—Ö–µ–º—ñ
‚îú‚îÄ‚îÄ data_analysis/           # –ü—ñ–¥–≥–æ—Ç–æ–≤–∫–∞ ML-–¥–∞—Ç–∞—Å–µ—Ç—ñ–≤ —Ç–∞ ML-–∞–Ω–∞–ª—ñ–∑
‚îÇ   ‚îú‚îÄ‚îÄ prepare_ml_datasets.py          # PySpark-–ø–∞–π–ø–ª–∞–π–Ω: —Ä–µ–≥—Ä–µ—Å—ñ—è + –∫–ª–∞—Å–∏—Ñ—ñ–∫–∞—Ü—ñ—è
‚îÇ   ‚îú‚îÄ‚îÄ prepare_classification_dataset.py # –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∞ Pandas-–ø—ñ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫–ª–∞—Å–∏—Ñ—ñ–∫–∞—Ü—ñ—ó
‚îÇ   ‚îú‚îÄ‚îÄ regression_modeling.py          # (–∑–∞–≥–ª—É—à–∫–∞) –º–æ–¥–µ–ª—ñ —Ä–µ–≥—Ä–µ—Å—ñ—ó
‚îÇ   ‚îú‚îÄ‚îÄ classification_modeling.py      # (–∑–∞–≥–ª—É—à–∫–∞) –º–æ–¥–µ–ª—ñ –∫–ª–∞—Å–∏—Ñ—ñ–∫–∞—Ü—ñ—ó
‚îÇ   ‚îî‚îÄ‚îÄ ML_DATASETS_DATA_CARD.md        # Data card –¥–ª—è ML-–¥–∞—Ç–∞—Å–µ—Ç—ñ–≤
‚îú‚îÄ‚îÄ contribution/            # –í–Ω–µ—Å–∫–∏ —á–ª–µ–Ω—ñ–≤ –∫–æ–º–∞–Ω–¥–∏
‚îú‚îÄ‚îÄ output/                  # –†–µ–∑—É–ª—å—Ç–∞—Ç–∏ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è
‚îÇ   ‚îî‚îÄ‚îÄ results/             # CSV —Ñ–∞–π–ª–∏ –∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏
‚îú‚îÄ‚îÄ main.py                  # –ì–æ–ª–æ–≤–Ω–∏–π —Ñ–∞–π–ª –¥–ª—è –∑–∞–ø—É—Å–∫—É (–º–µ–Ω—é —Å—Ç–∞–¥—ñ–π –ø–∞–π–ø–ª–∞–π–Ω—É)
‚îú‚îÄ‚îÄ requirements.txt         # Python –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ
‚îú‚îÄ‚îÄ README.md                # –¶–µ–π —Ñ–∞–π–ª
‚îî‚îÄ‚îÄ DOCKER_USAGE.md          # –î–µ—Ç–∞–ª—å–Ω–∞ —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—è –∑ Docker
```

## üîß –¢–µ—Ö–Ω–æ–ª–æ–≥—ñ—ó

- **Apache Spark 3.4.1** - –¥–ª—è –æ–±—Ä–æ–±–∫–∏ –≤–µ–ª–∏–∫–∏—Ö –¥–∞–Ω–∏—Ö
- **PySpark** - Python API –¥–ª—è Spark
- **Docker** - –¥–ª—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü—ñ—ó
- **Python 3.9** - –º–æ–≤–∞ –ø—Ä–æ–≥—Ä–∞–º—É–≤–∞–Ω–Ω—è

## üìä –ó—ñ—Ä—á–∞—Å—Ç–∞ —Å—Ö–µ–º–∞ –¥–∞–Ω–∏—Ö

### Dim_User (–í–∏–º—ñ—Ä –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤)
- User_SK, User_ID, Username, Gender, Birthday, Location, Joined_Date
- User_Mean_Score, User_Total_Completed, —Ç–∞ —ñ–Ω—à—ñ –∞—Ç—Ä–∏–±—É—Ç–∏

### Dim_Anime (–í–∏–º—ñ—Ä –∞–Ω—ñ–º–µ)
- Anime_SK, Anime_ID, Name, English_Name, Type, Source, Genres
- Studios, Avg_Score, Popularity_Rank, Episodes, Age_Rating

### Dim_Date (–í–∏–º—ñ—Ä –¥–∞—Ç–∏)
- Date_SK, Full_Date, Year, Quarter, Month, Month_Name
- Day_of_Week, Is_Weekend

### Fact_UserRatings (–¢–∞–±–ª–∏—Ü—è —Ñ–∞–∫—Ç—ñ–≤)
- User_SK, Anime_SK, Date_SK
- User_Rating, Rating_Deviation, Is_Above_Average
- Is_High_Rating, Is_Low_Rating, Rating_Count

## üí° –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è

–ü—ñ—Å–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –∑—ñ—Ä—á–∞—Å—Ç–æ—ó —Å—Ö–µ–º–∏, –≤–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —ó—ó –¥–ª—è –±—ñ–∑–Ω–µ—Å-–ø–∏—Ç–∞–Ω—å.

### –ë—ñ–∑–Ω–µ—Å-–ø–∏—Ç–∞–Ω–Ω—è

–ü—Ä–æ–µ–∫—Ç –º—ñ—Å—Ç–∏—Ç—å –º–æ–¥—É–ª—å `transformation/business_questions.py` –¥–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –±—ñ–∑–Ω–µ—Å-–ø–∏—Ç–∞–Ω—å –¥–æ –¥–∞–Ω–∏—Ö.

#### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –±—ñ–∑–Ω–µ—Å-–ø–∏—Ç–∞–Ω—å

–ö–æ–∂–µ–Ω —á–ª–µ–Ω –∫–æ–º–∞–Ω–¥–∏ –º–æ–∂–µ –¥–æ–¥–∞—Ç–∏ —Å–≤–æ—ó –±—ñ–∑–Ω–µ—Å-–ø–∏—Ç–∞–Ω–Ω—è —É —Ñ–∞–π–ª `business_questions.py`:

1. **–°—Ç–≤–æ—Ä—ñ—Ç—å —Ñ—É–Ω–∫—Ü—ñ—ó –¥–ª—è –≤–∞—à–∏—Ö –ø–∏—Ç–∞–Ω—å** —É —Ñ–æ—Ä–º–∞—Ç—ñ:
   ```python
   def question_N_yourname(fact_ratings, dim_user, dim_anime, dim_date):
       '''–û–ø–∏—Å –ø–∏—Ç–∞–Ω–Ω—è'''
       print("\n" + "=" * 60)
       print("‚ùì –ü–∏—Ç–∞–Ω–Ω—è N –≤—ñ–¥ [–í–∞—à–µ —ñ–º'—è]")
       print("=" * 60)
       # –í–∞—à –∫–æ–¥ —Ç—É—Ç
       result = ...
       result.show()
       return result
   ```

2. **–°—Ç–≤–æ—Ä—ñ—Ç—å —Ñ—É–Ω–∫—Ü—ñ—é –¥–ª—è –∑–∞–ø—É—Å–∫—É –≤—Å—ñ—Ö –≤–∞—à–∏—Ö –ø–∏—Ç–∞–Ω—å**:
   ```python
   def run_yourname_questions(fact_ratings, dim_user, dim_anime, dim_date, results_path="results"):
       '''–ó–∞–ø—É—Å–∫–∞—î –≤—Å—ñ –±—ñ–∑–Ω–µ—Å-–ø–∏—Ç–∞–Ω–Ω—è –≤—ñ–¥ [–í–∞—à–µ —ñ–º'—è]'''
       print("\n" + "=" * 60)
       print("üìä –ë–Ü–ó–ù–ï–°-–ü–ò–¢–ê–ù–ù–Ø –í–Ü–î [–í–ê–®–ï –Ü–ú'–Ø]")
       print("=" * 60)
       results = {}
       results['yourname_q1'] = question_1_yourname(fact_ratings, dim_user, dim_anime, dim_date)
       # –î–æ–¥–∞–π—Ç–µ —ñ–Ω—à—ñ –ø–∏—Ç–∞–Ω–Ω—è...
       return results
   ```

3. **–î–æ–¥–∞–π—Ç–µ –≤–∏–∫–ª–∏–∫ –≤–∞—à–æ—ó —Ñ—É–Ω–∫—Ü—ñ—ó –≤ `main.py`** (–∞–±–æ –æ–∫—Ä–µ–º–∏–π —Å—Ü–µ–Ω–∞—Ä—ñ–π, —è–∫—â–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ):
   ```python
   from transformation.business_questions import run_yourname_questions
   results_yourname = run_yourname_questions(
       fact_ratings, dim_user, dim_anime, dim_date,
       results_path=f"{data_path}/results"
   )
   ```

#### –í–∏–º–æ–≥–∏ –¥–æ –±—ñ–∑–Ω–µ—Å-–ø–∏—Ç–∞–Ω—å

–ó–≥—ñ–¥–Ω–æ –∑ –≤–∏–º–æ–≥–∞–º–∏ –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–æ—ó —Ä–æ–±–æ—Ç–∏, –∫–æ–∂–µ–Ω —á–ª–µ–Ω –∫–æ–º–∞–Ω–¥–∏ –º–∞—î —Å—Ç–≤–æ—Ä–∏—Ç–∏ **6 –±—ñ–∑–Ω–µ—Å-–ø–∏—Ç–∞–Ω—å**, —è–∫—ñ –≤–∫–ª—é—á–∞—é—Ç—å:

- **–ú—ñ–Ω—ñ–º—É–º 3 –ø–∏—Ç–∞–Ω–Ω—è –∑ filters** (—Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—è –¥–∞–Ω–∏—Ö)
- **–ú—ñ–Ω—ñ–º—É–º 2 –ø–∏—Ç–∞–Ω–Ω—è –∑ JOIN** (–æ–±'—î–¥–Ω–∞–Ω–Ω—è —Ç–∞–±–ª–∏—Ü—å)
- **–ú—ñ–Ω—ñ–º—É–º 2 –ø–∏—Ç–∞–Ω–Ω—è –∑ GROUP BY** (–≥—Ä—É–ø—É–≤–∞–Ω–Ω—è –¥–∞–Ω–∏—Ö)
- **–ú—ñ–Ω—ñ–º—É–º 2 –ø–∏—Ç–∞–Ω–Ω—è –∑ Window Functions** (–≤—ñ–∫–æ–Ω–Ω—ñ —Ñ—É–Ω–∫—Ü—ñ—ó)

#### –†–µ–∑—É–ª—å—Ç–∞—Ç–∏

–†–µ–∑—É–ª—å—Ç–∞—Ç–∏ –≤—Å—ñ—Ö –±—ñ–∑–Ω–µ—Å-–ø–∏—Ç–∞–Ω—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è —É CSV —Ñ–∞–π–ª–∏ –≤ –ø–∞–ø—Ü—ñ `data/results/`:
- `artem_q1.csv`, `artem_q2.csv`, ... (–¥–ª—è –ø–∏—Ç–∞–Ω—å –≤—ñ–¥ Artem)
- `oskar_q1.csv`, `oskar_q2.csv`, ... (–¥–ª—è –ø–∏—Ç–∞–Ω—å –≤—ñ–¥ Oskar)
- `yourname_q1.csv`, `yourname_q2.csv`, ... (–¥–ª—è –≤–∞—à–∏—Ö –ø–∏—Ç–∞–Ω—å)

#### –ë—ñ–∑–Ω–µ—Å-–ø–∏—Ç–∞–Ω–Ω—è –≤—ñ–¥ Oskar

–ü—Ä–æ–µ–∫—Ç –º—ñ—Å—Ç–∏—Ç—å 6 –¥–æ–¥–∞—Ç–∫–æ–≤–∏—Ö –±—ñ–∑–Ω–µ—Å-–ø–∏—Ç–∞–Ω—å –≤—ñ–¥ Oskar, —è–∫—ñ –¥–µ–º–æ–Ω—Å—Ç—Ä—É—é—Ç—å —Ä—ñ–∑–Ω—ñ —Ç–∏–ø–∏ –∞–Ω–∞–ª—ñ–∑—É –¥–∞–Ω–∏—Ö:

1. **–ü–∏—Ç–∞–Ω–Ω—è 1 (Filters)**: –ó–Ω–∞–π—Ç–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤, —á–∏—è —Å–µ—Ä–µ–¥–Ω—è –æ—Ü—ñ–Ω–∫–∞ (`User_Mean_Score`) –Ω–∏–∂—á–∞ –∑–∞ 6, –∞–ª–µ —è–∫—ñ –ø—Ä–∏ —Ü—å–æ–º—É –ø–æ–¥–∏–≤–∏–ª–∏—Å—è (`User_Total_Completed`) –±—ñ–ª—å—à–µ 50 —Ç–∞–π—Ç–ª—ñ–≤. –¶–µ –ø–∏—Ç–∞–Ω–Ω—è –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—é –¥–ª—è –≤–∏—è–≤–ª–µ–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ –∑ –Ω–∏–∑—å–∫–æ—é —Å–µ—Ä–µ–¥–Ω—å–æ—é –æ—Ü—ñ–Ω–∫–æ—é, –∞–ª–µ –≤–∏—Å–æ–∫–æ—é –∞–∫—Ç–∏–≤–Ω—ñ—Å—Ç—é –ø–µ—Ä–µ–≥–ª—è–¥—É.

2. **–ü–∏—Ç–∞–Ω–Ω—è 2 (JOIN)**: –í–∏–≤–µ—Å—Ç–∏ —Å–ø–∏—Å–æ–∫ –∞–Ω—ñ–º–µ —Ç–∞ –æ—Ü—ñ–Ω–æ–∫, —è–∫—ñ –ø–æ—Å—Ç–∞–≤–∏–≤ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á 'Slayer' (`Dim_User.Username`), –∞–ª–µ –ª–∏—à–µ –¥–ª—è —Ç–∏—Ö –∞–Ω—ñ–º–µ, –¥–µ —Ü–µ–π –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á —î "–∫—Ä–∏—Ç–∏–∫–æ–º" (`Fact.Rating_Deviation < 0`). –î–µ–º–æ–Ω—Å—Ç—Ä—É—î –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è JOIN –¥–ª—è –æ–±'—î–¥–Ω–∞–Ω–Ω—è —Ç–∞–±–ª–∏—Ü—å —Ñ–∞–∫—Ç—ñ–≤ —Ç–∞ –≤–∏–º—ñ—Ä—ñ–≤ –∑ –¥–æ–¥–∞—Ç–∫–æ–≤–æ—é —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—î—é.

3. **–ü–∏—Ç–∞–Ω–Ω—è 3 (GROUP BY)**: –Ø–∫–∞ —Å–µ—Ä–µ–¥–Ω—è –∫—ñ–ª—å–∫—ñ—Å—Ç—å –µ–ø—ñ–∑–æ–¥—ñ–≤ (`AVG(Dim_Anime.Episodes)`) –¥–ª—è –∞–Ω—ñ–º–µ, –∑–≥—Ä—É–ø–æ–≤–∞–Ω–∏—Ö –∑–∞ –≤—ñ–∫–æ–≤–∏–º —Ä–µ–π—Ç–∏–Ω–≥–æ–º (`Dim_Anime.Age_Rating`)? –ê–Ω–∞–ª—ñ–∑—É—î —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∞–Ω—ñ–º–µ –∑–∞ –≤—ñ–∫–æ–≤–∏–º–∏ –∫–∞—Ç–µ–≥–æ—Ä—ñ—è–º–∏.

4. **–ü–∏—Ç–∞–Ω–Ω—è 4 (GROUP BY)**: –Ø–∫–∞ —Å–µ—Ä–µ–¥–Ω—è —Ä—ñ–∑–Ω–∏—Ü—è (`AVG(Fact.Rating_Deviation)`) –º—ñ–∂ –æ—Ü—ñ–Ω–∫–æ—é –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ —Ç–∞ —Å–µ—Ä–µ–¥–Ω—å–æ—é –æ—Ü—ñ–Ω–∫–æ—é –∞–Ω—ñ–º–µ –¥–ª—è –∫–æ–∂–Ω–æ—ó —Å—Ç—É–¥—ñ—ó (`Dim_Anime.Studios`)? –î–æ–ø–æ–º–∞–≥–∞—î –≤–∏–∑–Ω–∞—á–∏—Ç–∏, —è–∫—ñ —Å—Ç—É–¥—ñ—ó –æ—Ç—Ä–∏–º—É—é—Ç—å –±—ñ–ª—å—à –∫—Ä–∏—Ç–∏—á–Ω—ñ –∞–±–æ –±—ñ–ª—å—à –ø–æ–∑–∏—Ç–∏–≤–Ω—ñ –æ—Ü—ñ–Ω–∫–∏ –≤—ñ–¥ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤.

5. **–ü–∏—Ç–∞–Ω–Ω—è 5 (GROUP BY)**: –°–∫—ñ–ª—å–∫–∏ –≤—Å—å–æ–≥–æ –æ—Ü—ñ–Ω–æ–∫ (`COUNT(Fact.Rating_Count)`) –ø–æ—Å—Ç–∞–≤–∏–ª–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ, –∑–≥—Ä—É–ø–æ–≤–∞–Ω—ñ –∑–∞ —Å—Ç–∞—Ç—Ç—é (`Dim_User.Gender`)? –ê–Ω–∞–ª—ñ–∑—É—î –∞–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ –∑–∞ –≥–µ–Ω–¥–µ—Ä–Ω–æ—é –æ–∑–Ω–∞–∫–æ—é.

6. **–ü–∏—Ç–∞–Ω–Ω—è 6 (Window Functions)**: –†–æ–∑–¥—ñ–ª–∏—Ç–∏ –≤—Å—ñ—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ –Ω–∞ 5 –≥—Ä—É–ø (–∫–≤—ñ–Ω—Ç–∏–ª—ñ) (`NTILE(5)`) –Ω–∞ –æ—Å–Ω–æ–≤—ñ –∫—ñ–ª—å–∫–æ—Å—Ç—ñ –ø–µ—Ä–µ–≥–ª—è–Ω—É—Ç–∏—Ö –Ω–∏–º–∏ –∞–Ω—ñ–º–µ (`Dim_User.User_Total_Completed`), —â–æ–± –∑–Ω–∞–π—Ç–∏ "—Ö–∞—Ä–¥–∫–æ—Ä–Ω–∏—Ö" –≥–ª—è–¥–∞—á—ñ–≤. –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –≤—ñ–∫–æ–Ω–Ω—ñ —Ñ—É–Ω–∫—Ü—ñ—ó –¥–ª—è —Å–µ–≥–º–µ–Ω—Ç–∞—Ü—ñ—ó –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ –∑–∞ —Ä—ñ–≤–Ω–µ–º –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ.

–í—Å—ñ —Ü—ñ –ø–∏—Ç–∞–Ω–Ω—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –≤–∏–∫–æ–Ω—É—é—Ç—å—Å—è –ø—Ä–∏ –∑–∞–ø—É—Å–∫—É `main.py` —Ç–∞ –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏ —É CSV —Ñ–∞–π–ª–∏.

#### –ü—Ä–∏–∫–ª–∞–¥ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –∑—ñ—Ä—á–∞—Å—Ç–æ—ó —Å—Ö–µ–º–∏

```python
# –ü—Ä–∏–∫–ª–∞–¥ –±—ñ–∑–Ω–µ—Å-–ø–∏—Ç–∞–Ω–Ω—è –∑ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è–º –∑—ñ—Ä—á–∞—Å—Ç–æ—ó —Å—Ö–µ–º–∏
result = fact_ratings \
    .join(dim_anime, on="Anime_SK") \
    .filter(col("Avg_Score") >= 8) \
    .groupBy("Type") \
    .count() \
    .orderBy("count", ascending=False)
result.show()
```

## üìù –î–æ–¥–∞—Ç–∫–æ–≤–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è

- [DOCKER_USAGE.md](DOCKER_USAGE.md) - –¥–µ—Ç–∞–ª—å–Ω–∞ —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—è –∑ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è Docker
- [GIT_FILES.md](GIT_FILES.md) - —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ —Ñ–∞–π–ª–∏ –≤ Git

## üë• –ö–æ–º–∞–Ω–¥–∞

–ü—Ä–æ–µ–∫—Ç –≤–∏–∫–æ–Ω—É—î—Ç—å—Å—è –∫–æ–º–∞–Ω–¥–æ—é –¥–ª—è –¥–∏—Å—Ü–∏–ø–ª—ñ–Ω–∏ "–ê–Ω–∞–ª—ñ–∑ –í–µ–ª–∏–∫–∏—Ö –¥–∞–Ω–∏—Ö".

## üìÑ –õ—ñ—Ü–µ–Ω–∑—ñ—è

–¶–µ–π –ø—Ä–æ–µ–∫—Ç —Å—Ç–≤–æ—Ä–µ–Ω–æ –¥–ª—è –Ω–∞–≤—á–∞–ª—å–Ω–∏—Ö —Ü—ñ–ª–µ–π.
