# Anime Spark Project

–ü—Ä–æ–µ–∫—Ç –¥–ª—è –∞–Ω–∞–ª—ñ–∑—É –¥–∞—Ç–∞—Å–µ—Ç—É –∞–Ω—ñ–º–µ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é Apache Spark —Ç–∞ –∑—ñ—Ä—á–∞—Å—Ç–æ—ó —Å—Ö–µ–º–∏ –¥–∞–Ω–∏—Ö.

## üìã –û–ø–∏—Å

–¶–µ–π –ø—Ä–æ–µ–∫—Ç —Å—Ç–≤–æ—Ä—é—î –∑—ñ—Ä—á–∞—Å—Ç—É —Å—Ö–µ–º—É –¥–∞–Ω–∏—Ö (Star Schema) –¥–ª—è –∞–Ω–∞–ª—ñ–∑—É –∞–Ω—ñ–º–µ –¥–∞—Ç–∞—Å–µ—Ç—É, —â–æ –≤–∫–ª—é—á–∞—î:
- **Dim_User** - –≤–∏–º—ñ—Ä –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ (731,290 –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤)
- **Dim_Anime** - –≤–∏–º—ñ—Ä –∞–Ω—ñ–º–µ (40,779 –∞–Ω—ñ–º–µ)
- **Dim_Date** - –≤–∏–º—ñ—Ä –¥–∞—Ç–∏ (9,497 –¥–∞—Ç)
- **Fact_UserRatings** - —Ç–∞–±–ª–∏—Ü—è —Ñ–∞–∫—Ç—ñ–≤ –∑ –æ—Ü—ñ–Ω–∫–∞–º–∏ (23,866,768 –æ—Ü—ñ–Ω–æ–∫)

## üöÄ –®–≤–∏–¥–∫–∏–π —Å—Ç–∞—Ä—Ç

### –í–∏–º–æ–≥–∏

- Docker Desktop –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–π —Ç–∞ –∑–∞–ø—É—â–µ–Ω–∏–π
- –î–∞–Ω—ñ –¥–∞—Ç–∞—Å–µ—Ç—É –≤ –ø–∞–ø—Ü—ñ `data/`

### –ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ Docker

1. **–ü–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—è, —â–æ Docker –∑–∞–ø—É—â–µ–Ω–∏–π**

2. **–ó–±–µ—Ä—ñ—Ç—å Docker –æ–±—Ä–∞–∑** (—è–∫—â–æ —â–µ –Ω–µ –∑—ñ–±—Ä–∞–Ω–æ):
   ```bash
   docker build -t my-spark-img .
   ```

3. **–ó–∞–ø—É—Å—Ç—ñ—Ç—å —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –∑—ñ—Ä—á–∞—Å—Ç–æ—ó —Å—Ö–µ–º–∏**:
   ```bash
   docker run --rm -v "$(pwd):/app" -w /app my-spark-img python main.py
   ```

   –ê–±–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–π—Ç–µ —Å–∫—Ä–∏–ø—Ç:
   ```bash
   ./run_docker.sh
   ```

### –©–æ –≤—ñ–¥–±—É–≤–∞—î—Ç—å—Å—è –ø—Ä–∏ –∑–∞–ø—É—Å–∫—É

1. ‚úÖ –°—Ç–≤–æ—Ä—é—î—Ç—å—Å—è –∑—ñ—Ä—á–∞—Å—Ç–∞ —Å—Ö–µ–º–∞ –¥–∞–Ω–∏—Ö
2. ‚úÖ –ü–µ—Ä–µ–≤—ñ—Ä—è—î—Ç—å—Å—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å—Ç–≤–æ—Ä–µ–Ω–∏—Ö –≤–∏–º—ñ—Ä—ñ–≤
3. ‚úÖ –°—Ö–µ–º–∞ –∑–±–µ—Ä—ñ–≥–∞—î—Ç—å—Å—è —É Parquet —Ñ–æ—Ä–º–∞—Ç—ñ (–æ–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ)
4. ‚úÖ –ì–æ—Ç–æ–≤–∞ –¥–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –¥–ª—è –±—ñ–∑–Ω–µ—Å-–ø–∏—Ç–∞–Ω—å

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç—É

```
anime-spark-project/
‚îú‚îÄ‚îÄ data/                    # –°–∏—Ä—ñ –¥–∞–Ω—ñ –¥–∞—Ç–∞—Å–µ—Ç—É (–Ω–µ –≤ Git)
‚îÇ   ‚îú‚îÄ‚îÄ anime-dataset-2023.csv
‚îÇ   ‚îú‚îÄ‚îÄ users-details-2023.csv
‚îÇ   ‚îú‚îÄ‚îÄ users-score-2023.csv
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îú‚îÄ‚îÄ data_extraction.py       # –ú–æ–¥—É–ª—å –¥–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –∑—ñ—Ä—á–∞—Å—Ç–æ—ó —Å—Ö–µ–º–∏
‚îú‚îÄ‚îÄ main.py                  # –ì–æ–ª–æ–≤–Ω–∏–π —Ñ–∞–π–ª –¥–ª—è –∑–∞–ø—É—Å–∫—É
‚îú‚îÄ‚îÄ Dockerfile               # –ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è Docker –æ–±—Ä–∞–∑—É
‚îú‚îÄ‚îÄ requirements.txt         # Python –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ
‚îî‚îÄ‚îÄ README.md               # –¶–µ–π —Ñ–∞–π–ª
```

## üîß –¢–µ—Ö–Ω–æ–ª–æ–≥—ñ—ó

- **Apache Spark 3.4.1** - –¥–ª—è –æ–±—Ä–æ–±–∫–∏ –≤–µ–ª–∏–∫–∏—Ö –¥–∞–Ω–∏—Ö
- **PySpark** - Python API –¥–ª—è Spark
- **Docker** - –¥–ª—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü—ñ—ó
- **Python 3.9** - –º–æ–≤–∞ –ø—Ä–æ–≥—Ä–∞–º—É–≤–∞–Ω–Ω—è

## üìä –ó—ñ—Ä—á–∞—Å—Ç–∞ —Å—Ö–µ–º–∞ –¥–∞–Ω–∏—Ö

### Dim_User (–í–∏–º—ñ—Ä –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤)
- User_SK, User_ID, Username, Gender, Birthday, Location, Joined_Date
- User_Mean_Score, User_Total_Completed, —Ç–∞ —ñ–Ω—à—ñ –∞—Ç—Ä–∏–±—É—Ç–∏

### Dim_Anime (–í–∏–º—ñ—Ä –∞–Ω—ñ–º–µ)
- Anime_SK, Anime_ID, Name, English_Name, Type, Source, Genres
- Studios, Avg_Score, Popularity_Rank, Episodes, Age_Rating

### Dim_Date (–í–∏–º—ñ—Ä –¥–∞—Ç–∏)
- Date_SK, Full_Date, Year, Quarter, Month, Month_Name
- Day_of_Week, Is_Weekend

### Fact_UserRatings (–¢–∞–±–ª–∏—Ü—è —Ñ–∞–∫—Ç—ñ–≤)
- User_SK, Anime_SK, Date_SK
- User_Rating, Rating_Deviation, Is_Above_Average
- Is_High_Rating, Is_Low_Rating, Rating_Count

## üí° –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è

–ü—ñ—Å–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –∑—ñ—Ä—á–∞—Å—Ç–æ—ó —Å—Ö–µ–º–∏, –≤–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —ó—ó –¥–ª—è –±—ñ–∑–Ω–µ—Å-–ø–∏—Ç–∞–Ω—å:

```python
# –ü—Ä–∏–∫–ª–∞–¥ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –≤ main.py
result = fact_ratings \
    .join(dim_anime, on="Anime_SK") \
    .filter(col("Avg_Score") >= 8) \
    .groupBy("Type") \
    .count() \
    .orderBy("count", ascending=False)
result.show()
```

## üìù –î–æ–¥–∞—Ç–∫–æ–≤–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è

- [DOCKER_USAGE.md](DOCKER_USAGE.md) - –¥–µ—Ç–∞–ª—å–Ω–∞ —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—è –∑ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è Docker
- [GIT_FILES.md](GIT_FILES.md) - —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ —Ñ–∞–π–ª–∏ –≤ Git

## üë• –ö–æ–º–∞–Ω–¥–∞

–ü—Ä–æ–µ–∫—Ç –≤–∏–∫–æ–Ω—É—î—Ç—å—Å—è –∫–æ–º–∞–Ω–¥–æ—é –¥–ª—è –¥–∏—Å—Ü–∏–ø–ª—ñ–Ω–∏ "–ê–Ω–∞–ª—ñ–∑ –í–µ–ª–∏–∫–∏—Ö –¥–∞–Ω–∏—Ö".

## üìÑ –õ—ñ—Ü–µ–Ω–∑—ñ—è

–¶–µ–π –ø—Ä–æ–µ–∫—Ç —Å—Ç–≤–æ—Ä–µ–Ω–æ –¥–ª—è –Ω–∞–≤—á–∞–ª—å–Ω–∏—Ö —Ü—ñ–ª–µ–π.
